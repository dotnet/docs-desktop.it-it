---
title: Rendering dei controlli con stili visivi
ms.date: 03/30/2017
helpviewer_keywords:
- professional appearance [Windows Forms], rendering Windows Forms controls
- themes [Windows Forms], XP visual styles in Window Forms
- custom controls [Windows Forms], rendering
- custom controls [Windows Forms], painting
- visual themes [Windows Forms], rendering Windows Forms controls
- user controls [Windows Forms], painting
- visual styles [Windows Forms], rendering Windows Forms controls
ms.assetid: a5b178ba-610e-46c4-a6c0-509c0886a744
ms.openlocfilehash: 32bcbab585c39be4a72150bf49820d4a16f1691f
ms.sourcegitcommit: 9f6df084c53a3da0ea657ed0d708a72213683084
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/09/2020
ms.locfileid: "96964333"
---
# <a name="rendering-controls-with-visual-styles"></a><span data-ttu-id="768cb-102">Rendering dei controlli con stili visivi</span><span class="sxs-lookup"><span data-stu-id="768cb-102">Rendering Controls with Visual Styles</span></span>
<span data-ttu-id="768cb-103">Il .NET Framework fornisce supporto per il rendering dei controlli e di altri elementi dell'interfaccia utente (UI) di Windows usando gli stili di visualizzazione nei sistemi operativi che li supportano.</span><span class="sxs-lookup"><span data-stu-id="768cb-103">The .NET Framework provides support for rendering controls and other Windows user interface (UI) elements using visual styles in operating systems that support them.</span></span> <span data-ttu-id="768cb-104">In questo argomento vengono illustrati i diversi livelli di supporto nella .NET Framework per il rendering dei controlli e di altri elementi dell'interfaccia utente con lo stile di visualizzazione corrente del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="768cb-104">This topic discusses the several levels of support in the .NET Framework for rendering controls and other UI elements with the current visual style of the operating system.</span></span>  
  
## <a name="rendering-classes-for-common-controls"></a><span data-ttu-id="768cb-105">Classi di rendering per i controlli comuni</span><span class="sxs-lookup"><span data-stu-id="768cb-105">Rendering Classes for Common Controls</span></span>  
 <span data-ttu-id="768cb-106">Il rendering di un controllo si riferisce alla grafica dell'interfaccia utente di un controllo.</span><span class="sxs-lookup"><span data-stu-id="768cb-106">Rendering a control refers to drawing the user interface of a control.</span></span> <span data-ttu-id="768cb-107">Lo spazio dei nomi <xref:System.Windows.Forms?displayProperty=nameWithType> include la classe <xref:System.Windows.Forms.ControlPaint> per il rendering di alcuni controlli comuni di Windows Form.</span><span class="sxs-lookup"><span data-stu-id="768cb-107">The <xref:System.Windows.Forms?displayProperty=nameWithType> namespace provides the <xref:System.Windows.Forms.ControlPaint> class for rendering some common Windows Forms controls.</span></span> <span data-ttu-id="768cb-108">Questa classe consente tuttavia di disegnare controlli nello stile classico di Windows, pertanto può essere difficile mantenere un'esperienza coerente per l'interfaccia utente quando si creano controlli personalizzati nelle applicazioni in cui sono abilitati gli stili di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="768cb-108">However, this class draws controls in the classic Windows style, which can make it difficult to maintain a consistent UI experience when drawing custom controls in applications with visual styles enabled.</span></span>  
  
 <span data-ttu-id="768cb-109">Il .NET Framework 2,0 include le classi nello <xref:System.Windows.Forms?displayProperty=nameWithType> spazio dei nomi che eseguono il rendering delle parti e degli Stati dei controlli comuni con gli stili di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="768cb-109">The .NET Framework 2.0 includes classes in the <xref:System.Windows.Forms?displayProperty=nameWithType> namespace that render the parts and states of common controls with visual styles.</span></span> <span data-ttu-id="768cb-110">Ciascuna di queste classi include metodi `static` per la creazione del controllo o delle relative parti in un determinato stato con lo stile di visualizzazione corrente del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="768cb-110">Each of these classes includes `static` methods for drawing the control or parts of the control in a particular state with the current visual style of the operating system.</span></span>  
  
 <span data-ttu-id="768cb-111">Alcune di queste classi sono progettate per creare il relativo controllo, indipendentemente dalla disponibilità degli stili di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="768cb-111">Some of these classes are designed to draw the related control regardless of whether visual styles are available.</span></span> <span data-ttu-id="768cb-112">Se gli stili di visualizzazione sono abilitati, i membri della classe creeranno il relativo controllo con gli stili impostati. Se invece sono disabilitati, i membri della classe creeranno il controllo nello stile classico di Windows.</span><span class="sxs-lookup"><span data-stu-id="768cb-112">If visual styles are enabled, then the class members will draw the related control with visual styles; if visual styles are disabled, then the class members will draw the control in the classic Windows style.</span></span> <span data-ttu-id="768cb-113">Tali classi includono:</span><span class="sxs-lookup"><span data-stu-id="768cb-113">These classes include:</span></span>  
  
- <xref:System.Windows.Forms.ButtonRenderer>  
  
- <xref:System.Windows.Forms.CheckBoxRenderer>  
  
- <xref:System.Windows.Forms.GroupBoxRenderer>  
  
- <xref:System.Windows.Forms.RadioButtonRenderer>  
  
 <span data-ttu-id="768cb-114">Altre classi possono creare il relativo controllo solo quando sono disponibili gli stili di visualizzazione e i membri di tali classi genereranno un'eccezione se gli stili di visualizzazione sono disabilitati.</span><span class="sxs-lookup"><span data-stu-id="768cb-114">Other classes can only draw the related control when visual styles are available, and their members will throw an exception if visual styles are disabled.</span></span> <span data-ttu-id="768cb-115">Tali classi includono:</span><span class="sxs-lookup"><span data-stu-id="768cb-115">These classes include:</span></span>  
  
- <xref:System.Windows.Forms.ComboBoxRenderer>  
  
- <xref:System.Windows.Forms.ProgressBarRenderer>  
  
- <xref:System.Windows.Forms.ScrollBarRenderer>  
  
- <xref:System.Windows.Forms.TabRenderer>  
  
- <xref:System.Windows.Forms.TextBoxRenderer>  
  
- <xref:System.Windows.Forms.TrackBarRenderer>  
  
 <span data-ttu-id="768cb-116">Per altre informazioni sull'uso di queste classi per la creazione di un controllo, vedere [How to: Use a Control Rendering Class](how-to-use-a-control-rendering-class.md).</span><span class="sxs-lookup"><span data-stu-id="768cb-116">For more information on using these classes to draw a control, see [How to: Use a Control Rendering Class](how-to-use-a-control-rendering-class.md).</span></span>  
  
## <a name="visual-style-element-and-rendering-classes"></a><span data-ttu-id="768cb-117">Elemento dello stile di visualizzazione e classi di rendering</span><span class="sxs-lookup"><span data-stu-id="768cb-117">Visual Style Element and Rendering Classes</span></span>  
 <span data-ttu-id="768cb-118">Lo spazio dei nomi <xref:System.Windows.Forms.VisualStyles?displayProperty=nameWithType> include classi che consentono di disegnare e ottenere informazioni su qualsiasi controllo o elemento dell'interfaccia utente supportato dagli stili di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="768cb-118">The <xref:System.Windows.Forms.VisualStyles?displayProperty=nameWithType> namespace includes classes that can be used to draw and get information about any control or UI element that is supported by visual styles.</span></span> <span data-ttu-id="768cb-119">I controlli supportati includono i controlli comuni che hanno una classe di rendering nello spazio dei nomi <xref:System.Windows.Forms?displayProperty=nameWithType> (vedere la sezione precedente), nonché altri controlli, ad esempio controlli Struttura a schede e controlli Rebar.</span><span class="sxs-lookup"><span data-stu-id="768cb-119">Supported controls include common controls that have a rendering class in the <xref:System.Windows.Forms?displayProperty=nameWithType> namespace (see the previous section), as well as other controls, such as tab controls and rebar controls.</span></span> <span data-ttu-id="768cb-120">Tra gli altri elementi dell'interfaccia utente supportati figurano le parti del menu **Start** , la barra delle applicazioni e l'area non client di Windows.</span><span class="sxs-lookup"><span data-stu-id="768cb-120">Other supported UI elements include the parts of the **Start** menu, the taskbar, and the nonclient area of windows.</span></span>  
  
 <span data-ttu-id="768cb-121">Le classi principali dello spazio dei nomi <xref:System.Windows.Forms.VisualStyles?displayProperty=nameWithType> sono <xref:System.Windows.Forms.VisualStyles.VisualStyleElement> e <xref:System.Windows.Forms.VisualStyles.VisualStyleRenderer>.</span><span class="sxs-lookup"><span data-stu-id="768cb-121">The main classes of the <xref:System.Windows.Forms.VisualStyles?displayProperty=nameWithType> namespace are <xref:System.Windows.Forms.VisualStyles.VisualStyleElement> and <xref:System.Windows.Forms.VisualStyles.VisualStyleRenderer>.</span></span> <span data-ttu-id="768cb-122"><xref:System.Windows.Forms.VisualStyles.VisualStyleElement> è una classe di base per l'identificazione di qualsiasi controllo o elemento dell'interfaccia utente supportato dagli stili di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="768cb-122"><xref:System.Windows.Forms.VisualStyles.VisualStyleElement> is a foundation class for identifying any control or user interface element supported by visual styles.</span></span> <span data-ttu-id="768cb-123">Oltre a <xref:System.Windows.Forms.VisualStyles.VisualStyleElement> , lo spazio dei nomi <xref:System.Windows.Forms.VisualStyles?displayProperty=nameWithType> include molte classi nidificate di <xref:System.Windows.Forms.VisualStyles.VisualStyleElement> con proprietà `static` che restituiscono un elemento <xref:System.Windows.Forms.VisualStyles.VisualStyleElement> per ogni stato di un controllo, di una parte di controllo o di un altro elemento dell'interfaccia utente supportato dagli stili di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="768cb-123">In addition to <xref:System.Windows.Forms.VisualStyles.VisualStyleElement> itself, the <xref:System.Windows.Forms.VisualStyles?displayProperty=nameWithType> namespace includes many nested classes of <xref:System.Windows.Forms.VisualStyles.VisualStyleElement> with `static` properties that return a <xref:System.Windows.Forms.VisualStyles.VisualStyleElement> for every state of a control, control part, or other UI element supported by visual styles.</span></span>  
  
 <span data-ttu-id="768cb-124"><xref:System.Windows.Forms.VisualStyles.VisualStyleRenderer> offre i metodi per disegnare e ottenere informazioni su ogni elemento <xref:System.Windows.Forms.VisualStyles.VisualStyleElement> definito dallo stile di visualizzazione corrente del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="768cb-124"><xref:System.Windows.Forms.VisualStyles.VisualStyleRenderer> provides the methods that draw and get information about each <xref:System.Windows.Forms.VisualStyles.VisualStyleElement> defined by the current visual style of the operating system.</span></span> <span data-ttu-id="768cb-125">Le informazioni che possono essere recuperate su un elemento includono la dimensione predefinita, il tipo di sfondo e le definizioni dei colori.</span><span class="sxs-lookup"><span data-stu-id="768cb-125">Information that can be retrieved about an element includes its default size, background type, and color definitions.</span></span> <span data-ttu-id="768cb-126"><xref:System.Windows.Forms.VisualStyles.VisualStyleRenderer> esegue il wrapping della funzionalità dell'API degli stili di visualizzazione (UxTheme) dalla parte della shell di Windows di Windows Platform SDK.</span><span class="sxs-lookup"><span data-stu-id="768cb-126"><xref:System.Windows.Forms.VisualStyles.VisualStyleRenderer> wraps the functionality of the visual styles (UxTheme) API from the Windows Shell portion of the Windows Platform SDK.</span></span> <span data-ttu-id="768cb-127">Per altre informazioni, vedere [Abilitazione degli stili di visualizzazione](/windows/desktop/controls/cookbook-overview).</span><span class="sxs-lookup"><span data-stu-id="768cb-127">For more information, see [Enabling Visual Styles](/windows/desktop/controls/cookbook-overview).</span></span>  
  
 <span data-ttu-id="768cb-128">Per altre informazioni sull'uso di <xref:System.Windows.Forms.VisualStyles.VisualStyleRenderer> e <xref:System.Windows.Forms.VisualStyles.VisualStyleElement>, vedere [How to: Render a Visual Style Element](how-to-render-a-visual-style-element.md).</span><span class="sxs-lookup"><span data-stu-id="768cb-128">For more information about using <xref:System.Windows.Forms.VisualStyles.VisualStyleRenderer> and <xref:System.Windows.Forms.VisualStyles.VisualStyleElement>, see [How to: Render a Visual Style Element](how-to-render-a-visual-style-element.md).</span></span>  
  
## <a name="enabling-visual-styles"></a><span data-ttu-id="768cb-129">Abilitazione degli stili di visualizzazione</span><span class="sxs-lookup"><span data-stu-id="768cb-129">Enabling Visual Styles</span></span>  
 <span data-ttu-id="768cb-130">Per abilitare gli stili di visualizzazione per un'applicazione scritta per la versione di .NET Framework 1,0, i programmatori devono includere un manifesto dell'applicazione che specifica che per disegnare i controlli verrà utilizzata ComCtl32.dll versione 6 o successiva.</span><span class="sxs-lookup"><span data-stu-id="768cb-130">To enable visual styles for an application written for the .NET Framework version 1.0, programmers must include an application manifest that specifies that ComCtl32.dll version 6 or later will be used to draw controls.</span></span> <span data-ttu-id="768cb-131">Le applicazioni compilate con il .NET Framework versione 1,1 o successive possono usare il <xref:System.Windows.Forms.Application.EnableVisualStyles%2A?displayProperty=nameWithType> metodo della <xref:System.Windows.Forms.Application> classe.</span><span class="sxs-lookup"><span data-stu-id="768cb-131">Applications built with the .NET Framework version 1.1 or later can use the <xref:System.Windows.Forms.Application.EnableVisualStyles%2A?displayProperty=nameWithType> method of the <xref:System.Windows.Forms.Application> class.</span></span>  
  
## <a name="checking-for-visual-styles-support"></a><span data-ttu-id="768cb-132">Verifica del supporto degli stili di visualizzazione</span><span class="sxs-lookup"><span data-stu-id="768cb-132">Checking for Visual Styles Support</span></span>  
 <span data-ttu-id="768cb-133">La proprietà <xref:System.Windows.Forms.Application.RenderWithVisualStyles%2A> della classe <xref:System.Windows.Forms.Application> indica se l'applicazione corrente sta creando i controlli con gli stili di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="768cb-133">The <xref:System.Windows.Forms.Application.RenderWithVisualStyles%2A> property of the <xref:System.Windows.Forms.Application> class indicates whether the current application is drawing controls with visual styles.</span></span> <span data-ttu-id="768cb-134">Quando si disegna un controllo personalizzato, è possibile controllare il valore di <xref:System.Windows.Forms.Application.RenderWithVisualStyles%2A> per determinare se è necessario eseguire il rendering del controllo con o senza gli stili di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="768cb-134">When painting a custom control, you can check the value of <xref:System.Windows.Forms.Application.RenderWithVisualStyles%2A> to determine whether you should render your control with or without visual styles.</span></span> <span data-ttu-id="768cb-135">La tabella seguente elenca le quattro condizioni necessarie affinché <xref:System.Windows.Forms.Application.RenderWithVisualStyles%2A> restituisca `true`.</span><span class="sxs-lookup"><span data-stu-id="768cb-135">The following table lists the four conditions that must exist for <xref:System.Windows.Forms.Application.RenderWithVisualStyles%2A> to return `true`.</span></span>  
  
|<span data-ttu-id="768cb-136">Condizione</span><span class="sxs-lookup"><span data-stu-id="768cb-136">Condition</span></span>|<span data-ttu-id="768cb-137">Note</span><span class="sxs-lookup"><span data-stu-id="768cb-137">Notes</span></span>|  
|---------------|-----------|  
|<span data-ttu-id="768cb-138">Il sistema operativo supporta gli stili di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="768cb-138">The operating system supports visual styles.</span></span>|<span data-ttu-id="768cb-139">Per verificare questa condizione separatamente, usare la proprietà <xref:System.Windows.Forms.VisualStyles.VisualStyleInformation.IsSupportedByOS%2A> della classe <xref:System.Windows.Forms.VisualStyles.VisualStyleInformation> .</span><span class="sxs-lookup"><span data-stu-id="768cb-139">To verify this condition separately, use the <xref:System.Windows.Forms.VisualStyles.VisualStyleInformation.IsSupportedByOS%2A> property of the <xref:System.Windows.Forms.VisualStyles.VisualStyleInformation> class.</span></span>|  
|<span data-ttu-id="768cb-140">L'utente ha abilitato gli stili di visualizzazione nel sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="768cb-140">The user has enabled visual styles in the operating system.</span></span>|<span data-ttu-id="768cb-141">Per verificare questa condizione separatamente, usare la proprietà <xref:System.Windows.Forms.VisualStyles.VisualStyleInformation.IsEnabledByUser%2A> della classe <xref:System.Windows.Forms.VisualStyles.VisualStyleInformation> .</span><span class="sxs-lookup"><span data-stu-id="768cb-141">To verify this condition separately, use the <xref:System.Windows.Forms.VisualStyles.VisualStyleInformation.IsEnabledByUser%2A> property of the <xref:System.Windows.Forms.VisualStyles.VisualStyleInformation> class.</span></span>|  
|<span data-ttu-id="768cb-142">Gli stili di visualizzazione sono abilitati nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="768cb-142">Visual styles are enabled in the application.</span></span>|<span data-ttu-id="768cb-143">Per abilitare gli stili di visualizzazione per un'applicazione, chiamare il metodo <xref:System.Windows.Forms.Application.EnableVisualStyles%2A?displayProperty=nameWithType> o usare un manifesto dell'applicazione in cui si specifica che per disegnare i controlli verrà usata ComCtl32.dll versione 6 o successiva.</span><span class="sxs-lookup"><span data-stu-id="768cb-143">Visual styles can be enabled in an application by calling the <xref:System.Windows.Forms.Application.EnableVisualStyles%2A?displayProperty=nameWithType> method or by using an application manifest that specifies that ComCtl32.dll version 6 or later will be used to draw controls.</span></span>|  
|<span data-ttu-id="768cb-144">Gli stili di visualizzazione vengono usati per disegnare l'area client delle finestre dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="768cb-144">Visual styles are being used to draw the client area of application windows.</span></span>|<span data-ttu-id="768cb-145">Per verificare questa condizione separatamente, usare la proprietà <xref:System.Windows.Forms.Application.VisualStyleState%2A> della classe <xref:System.Windows.Forms.Application> e verificare che abbia il valore <xref:System.Windows.Forms.VisualStyles.VisualStyleState.ClientAreaEnabled?displayProperty=nameWithType> o <xref:System.Windows.Forms.VisualStyles.VisualStyleState.ClientAndNonClientAreasEnabled?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="768cb-145">To verify this condition separately, use the <xref:System.Windows.Forms.Application.VisualStyleState%2A> property of the <xref:System.Windows.Forms.Application> class and verify that it has the value <xref:System.Windows.Forms.VisualStyles.VisualStyleState.ClientAreaEnabled?displayProperty=nameWithType> or <xref:System.Windows.Forms.VisualStyles.VisualStyleState.ClientAndNonClientAreasEnabled?displayProperty=nameWithType>.</span></span>|  
  
 <span data-ttu-id="768cb-146">Per determinare quando un utente abilita o disabilita gli stili di visualizzazione o passa da uno stile di visualizzazione a un altro, verificare la presenza del valore <xref:Microsoft.Win32.UserPreferenceCategory.VisualStyle?displayProperty=nameWithType> nei gestori per gli eventi <xref:Microsoft.Win32.SystemEvents.UserPreferenceChanging?displayProperty=nameWithType> o <xref:Microsoft.Win32.SystemEvents.UserPreferenceChanged?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="768cb-146">To determine when a user enables or disables visual styles, or switches from one visual style to another, check for the <xref:Microsoft.Win32.UserPreferenceCategory.VisualStyle?displayProperty=nameWithType> value in the handlers for the <xref:Microsoft.Win32.SystemEvents.UserPreferenceChanging?displayProperty=nameWithType> or <xref:Microsoft.Win32.SystemEvents.UserPreferenceChanged?displayProperty=nameWithType> events.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="768cb-147">Se si vuole usare <xref:System.Windows.Forms.VisualStyles.VisualStyleRenderer> per il rendering di un controllo o di un elemento dell'interfaccia utente quando l'utente abilita o cambia gli stili di visualizzazione, assicurarsi di eseguire l'operazione durante la gestione dell'evento <xref:Microsoft.Win32.SystemEvents.UserPreferenceChanged> anziché dell'evento <xref:Microsoft.Win32.SystemEvents.UserPreferenceChanging> .</span><span class="sxs-lookup"><span data-stu-id="768cb-147">If you want to use <xref:System.Windows.Forms.VisualStyles.VisualStyleRenderer> to render a control or UI element when the user enables or switches visual styles, make sure that you do this when handling the <xref:Microsoft.Win32.SystemEvents.UserPreferenceChanged> event instead of the <xref:Microsoft.Win32.SystemEvents.UserPreferenceChanging> event.</span></span> <span data-ttu-id="768cb-148">Se si usa la classe <xref:System.Windows.Forms.VisualStyles.VisualStyleRenderer> durante la gestione di <xref:Microsoft.Win32.SystemEvents.UserPreferenceChanging>, verrà generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="768cb-148">An exception will be thrown if you use the <xref:System.Windows.Forms.VisualStyles.VisualStyleRenderer> class when handling <xref:Microsoft.Win32.SystemEvents.UserPreferenceChanging>.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="768cb-149">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="768cb-149">See also</span></span>

- [<span data-ttu-id="768cb-150">Disegno e rendering di controlli personalizzati</span><span class="sxs-lookup"><span data-stu-id="768cb-150">Custom Control Painting and Rendering</span></span>](custom-control-painting-and-rendering.md)
