---
title: Ottimizzare le prestazioni 3D
ms.date: 03/30/2017
helpviewer_keywords:
- 3D graphics [WPF]
ms.assetid: 4bcf949d-d92f-4d8d-8a9b-1e4c61b25bf6
ms.openlocfilehash: 0cc7ce1d62fd9a21abc3130c0a799e1d3a049ca6
ms.sourcegitcommit: 9f6df084c53a3da0ea657ed0d708a72213683084
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/09/2020
ms.locfileid: "96966880"
---
# <a name="maximize-wpf-3d-performance"></a>Ottimizzazione delle prestazioni tridimensionali di WPF
Quando si usa [!INCLUDE[TLA#tla_winclient](../../../includes/tlasharptla-winclient-md.md)] per creare controlli 3D e includere scene 3D nelle applicazioni, è importante prendere in considerazione l'ottimizzazione delle prestazioni. In questo argomento viene fornito un elenco di classi e proprietà 3D con implicazioni sulle prestazioni per l'applicazione, oltre a consigli per l'ottimizzazione delle prestazioni quando vengono utilizzate.  
  
 Questo argomento presuppone una conoscenza avanzata delle [!INCLUDE[TLA#tla_winclient](../../../includes/tlasharptla-winclient-md.md)] funzionalità 3D. I suggerimenti di questo documento si applicano al livello di rendering 2, approssimativamente definito come hardware che supporta pixel shader versione 2,0 e vertex shader versione 2,0. Per altri dettagli, vedere [livelli di rendering della grafica](../advanced/graphics-rendering-tiers.md).  
  
## <a name="performance-impact-high"></a>Effetti sulle prestazioni: alto  
  
|Proprietà|Recommendation|  
|-|-|  
|<xref:System.Windows.Media.Brush>|Velocità del pennello (più veloce a più lenta):<br /><br /> <xref:System.Windows.Media.SolidColorBrush><br /><br /> <xref:System.Windows.Media.LinearGradientBrush><br /><br /> <xref:System.Windows.Media.ImageBrush><br /><br /> <xref:System.Windows.Media.DrawingBrush> cache<br /><br /> <xref:System.Windows.Media.VisualBrush> cache<br /><br /> <xref:System.Windows.Media.RadialGradientBrush><br /><br /> <xref:System.Windows.Media.DrawingBrush> fuori cache<br /><br /> <xref:System.Windows.Media.VisualBrush> fuori cache|  
|<xref:System.Windows.UIElement.ClipToBoundsProperty>|Impostare `Viewport3D.ClipToBounds` su false se non è necessario [!INCLUDE[TLA#tla_winclient](../../../includes/tlasharptla-winclient-md.md)] ritagliare in modo esplicito il contenuto di un oggetto nel <xref:System.Windows.Controls.Viewport3D> rettangolo Viewport3D. [!INCLUDE[TLA#tla_winclient](../../../includes/tlasharptla-winclient-md.md)] il ritaglio con antialias può essere molto lento ed `ClipToBounds` è abilitato (lento) per impostazione predefinita su <xref:System.Windows.Controls.Viewport3D> .|  
|<xref:System.Windows.UIElement.IsHitTestVisible%2A>|Impostare `Viewport3D.IsHitTestVisible` su false se non è necessario [!INCLUDE[TLA#tla_winclient](../../../includes/tlasharptla-winclient-md.md)] prendere in considerazione il contenuto di un oggetto <xref:System.Windows.Controls.Viewport3D> quando si esegue l'hit test del mouse.  Il contenuto 3D di hit testing viene eseguito nel software e può essere lento con mesh di grandi dimensioni. <xref:System.Windows.UIElement.IsHitTestVisible%2A> è abilitato (lento) per impostazione predefinita su <xref:System.Windows.Controls.Viewport3D> .|  
|<xref:System.Windows.Media.Media3D.GeometryModel3D>|Creare modelli diversi solo quando richiedono materiali o trasformazioni differenti.  In caso contrario, provare a unire molte <xref:System.Windows.Media.Media3D.GeometryModel3D> istanze con lo stesso materiale e le stesse trasformazioni in alcune istanze più grandi <xref:System.Windows.Media.Media3D.GeometryModel3D> <xref:System.Windows.Media.Media3D.MeshGeometry3D> .|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|L'animazione mesh, ovvero la modifica dei singoli vertici di una mesh in base ai singoli fotogrammi, non è sempre efficiente in [!INCLUDE[TLA#tla_winclient](../../../includes/tlasharptla-winclient-md.md)] .  Per ridurre al minimo l'impatto sulle prestazioni delle notifiche di modifica quando ogni vertice viene modificato, scollegare la mesh dalla struttura ad albero visuale prima di eseguire la modifica per ogni vertice.  Una volta modificata, la mesh viene ricollegata alla struttura ad albero visuale.  Inoltre, provare a ridurre al minimo le dimensioni dei mesh che verranno animate in questo modo.|  
|anti-aliasing 3D|Per aumentare la velocità di rendering, disabilitare il campionamento multiplo su un impostando <xref:System.Windows.Controls.Viewport3D> la proprietà associata su <xref:System.Windows.Media.RenderOptions.EdgeMode%2A> `Aliased` .  Per impostazione predefinita, l'anti-aliasing 3D è abilitato in Windows con 4 campioni per pixel.|  
|Testo|Il testo in tempo reale in una scena 3D (Live perché si trova in un <xref:System.Windows.Media.DrawingBrush> o <xref:System.Windows.Media.VisualBrush> ) può essere lento. Provare a usare le immagini del testo (via <xref:System.Windows.Media.Imaging.RenderTargetBitmap> ), a meno che il testo non venga modificato.|  
|<xref:System.Windows.Media.TileBrush>|Se è necessario usare un oggetto <xref:System.Windows.Media.VisualBrush> o <xref:System.Windows.Media.DrawingBrush> in una scena 3D perché il contenuto del pennello non è statico, provare a memorizzare nella cache il pennello (impostando la proprietà associata <xref:System.Windows.Media.RenderOptions.CachingHint%2A> su `Cache` ).  Impostare le soglie di invalidamento minime e massime per la scalabilità, con le proprietà associate <xref:System.Windows.Media.RenderOptions.CacheInvalidationThresholdMinimum%2A> e <xref:System.Windows.Media.RenderOptions.CacheInvalidationThresholdMaximum%2A> , in modo che i pennelli memorizzati nella cache non vengano rigenerati troppo spesso, mantenendo al tempo stesso il livello di qualità desiderato.  Per impostazione predefinita, <xref:System.Windows.Media.DrawingBrush> e <xref:System.Windows.Media.VisualBrush> non sono memorizzati nella cache, ovvero ogni volta che è necessario eseguire nuovamente il rendering di un elemento disegnato con il pennello, è necessario eseguire nuovamente il rendering dell'intero contenuto del pennello in una superficie intermedia.|  
|<xref:System.Windows.Media.Effects.BitmapEffect>|<xref:System.Windows.Media.Effects.BitmapEffect> impone il rendering di tutti i contenuti interessati senza accelerazione hardware.  Per ottenere prestazioni ottimali, non utilizzare <xref:System.Windows.Media.Effects.BitmapEffect> .|  
  
## <a name="performance-impact-medium"></a>Effetto sulle prestazioni: medio  
  
|Proprietà|Recommendation|  
|-|-|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Quando una mesh viene definita come triangoli adiacenti con vertici condivisi e i vertici hanno le stesse coordinate di posizione, normale e trama, definiscono ogni vertice condiviso una sola volta e quindi definiscono i triangoli in base all'indice con <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A> .|  
|<xref:System.Windows.Media.ImageBrush>|Provare a ridurre al minimo le dimensioni della trama quando si dispone di un controllo esplicito sulle dimensioni (quando si usa un <xref:System.Windows.Media.Imaging.RenderTargetBitmap> e/o un <xref:System.Windows.Media.ImageBrush> ).  Si noti che le trame con risoluzione inferiore possono ridurre la qualità visiva, quindi provare a trovare il giusto equilibrio tra qualità e prestazioni.|  
|Opacità|Quando si esegue il rendering di contenuto 3D traslucido (ad esempio Reflection), usare le proprietà di opacità sui pennelli o i materiali (tramite <xref:System.Windows.Media.Brush.Opacity%2A> o <xref:System.Windows.Media.Media3D.DiffuseMaterial.Color%2A> ) anziché creare un traslucido separato impostando <xref:System.Windows.Controls.Viewport3D> `Viewport3D.Opacity` su un valore minore di 1.|  
|<xref:System.Windows.Controls.Viewport3D>|Ridurre al minimo il numero di <xref:System.Windows.Controls.Viewport3D> oggetti utilizzati in una scena.  Inserire molti modelli 3D nello stesso oggetto Viewport3D anziché creare istanze Viewport3D separate per ogni modello.|  
|<xref:System.Windows.Freezable>|In genere è vantaggioso riutilizzare <xref:System.Windows.Media.Media3D.MeshGeometry3D> , <xref:System.Windows.Media.Media3D.GeometryModel3D> , pennelli e materiali.  Tutti sono con più elementi padre perché sono derivati da `Freezable` .|  
|<xref:System.Windows.Freezable>|Chiamare il <xref:System.Windows.Freezable.Freeze%2A> Metodo sugli Freezable quando le relative proprietà rimarranno invariate nell'applicazione.  Il blocco può ridurre working set e aumentare la velocità.|  
|<xref:System.Windows.Media.Brush>|Utilizzare <xref:System.Windows.Media.ImageBrush> invece di <xref:System.Windows.Media.VisualBrush> o <xref:System.Windows.Media.DrawingBrush> quando il contenuto del pennello non cambierà.  il contenuto 2D può essere convertito in un <xref:System.Windows.Controls.Image> via <xref:System.Windows.Media.Imaging.RenderTargetBitmap> e quindi usato in un oggetto <xref:System.Windows.Media.ImageBrush> .|  
|<xref:System.Windows.Media.Media3D.GeometryModel3D.BackMaterial%2A>|Non usare <xref:System.Windows.Media.Media3D.GeometryModel3D.BackMaterial%2A> , a meno che non sia effettivamente necessario visualizzare i visi indietro del <xref:System.Windows.Media.Media3D.GeometryModel3D> .|  
|<xref:System.Windows.Media.Media3D.Light>|Velocità chiara (veloce a più lenta):<br /><br /> <xref:System.Windows.Media.Media3D.AmbientLight><br /><br /> <xref:System.Windows.Media.Media3D.DirectionalLight><br /><br /> <xref:System.Windows.Media.Media3D.PointLight><br /><br /> <xref:System.Windows.Media.Media3D.SpotLight>|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Provare a ridurre le dimensioni dei mesh con i limiti seguenti:<br /><br /> <xref:System.Windows.Media.Media3D.MeshGeometry3D.Positions%2A>: 20.001 <xref:System.Windows.Media.Media3D.Point3D> istanze<br /><br /> <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>: 60.003 <xref:System.Int32> istanze|  
|<xref:System.Windows.Media.Media3D.Material>|Velocità del materiale (più veloce a più lenta):<br /><br /> <xref:System.Windows.Media.Media3D.EmissiveMaterial><br /><br /> <xref:System.Windows.Media.Media3D.DiffuseMaterial><br /><br /> <xref:System.Windows.Media.Media3D.SpecularMaterial>|  
|<xref:System.Windows.Media.Brush>|[!INCLUDE[TLA#tla_winclient](../../../includes/tlasharptla-winclient-md.md)] il 3D non rifiuta esplicitamente i pennelli invisibili (pennelli di ambiente neri, Cancella pennelli e così via) in modo coerente.  Si consiglia di ometterli dalla scena.|  
|<xref:System.Windows.Media.Media3D.MaterialGroup>|Ogni <xref:System.Windows.Media.Media3D.Material> in a <xref:System.Windows.Media.Media3D.MaterialGroup> causa un altro passaggio di rendering, che include molti materiali, anche materiali semplici, può aumentare significativamente le richieste di riempimento sulla GPU.  Ridurre al minimo il numero di materiali presenti nel <xref:System.Windows.Media.Media3D.MaterialGroup> .|  
  
## <a name="performance-impact-low"></a>Effetto sulle prestazioni: basso  
  
|Proprietà|Recommendation|  
|-|-|  
|<xref:System.Windows.Media.Media3D.Transform3DGroup>|Quando non è necessaria un'animazione o una data binding, anziché usare un gruppo di trasformazione contenente più trasformazioni, usare un singolo <xref:System.Windows.Media.Media3D.MatrixTransform3D> , impostando come prodotto tutte le trasformazioni che altrimenti sarebbero disponibili indipendentemente nel gruppo di trasformazione.|  
|<xref:System.Windows.Media.Media3D.Light>|Ridurre al minimo il numero di luci nella scena. Troppe luci in una scena forzano [!INCLUDE[TLA#tla_winclient](../../../includes/tlasharptla-winclient-md.md)] a eseguire il fallback al rendering del software.  I limiti sono approssimativamente 110 oggetti <xref:System.Windows.Media.Media3D.DirectionalLight> , 70 <xref:System.Windows.Media.Media3D.PointLight> oggetti o 40 <xref:System.Windows.Media.Media3D.SpotLight> oggetti.|  
|<xref:System.Windows.Media.Media3D.ModelVisual3D>|Separare gli oggetti mobili dagli oggetti statici inserendoli in <xref:System.Windows.Media.Media3D.ModelVisual3D> istanze separate.  ModelVisual3D è "più pesante" rispetto a <xref:System.Windows.Media.Media3D.GeometryModel3D> perché memorizza nella cache i limiti trasformati.  GeometryModel3D è ottimizzato per essere un modello; ModelVisual3D è ottimizzato per essere un nodo di scena.  Usare ModelVisual3D per inserire le istanze condivise di GeometryModel3D nella scena.|  
|<xref:System.Windows.Media.Media3D.Light>|Ridurre al minimo il numero di volte in cui si modifica il numero di luci nella scena.  Ogni modifica del numero di luce impone una rigenerazione dello shader e la ricompilazione a meno che la configurazione non sia già stata eseguita in precedenza (e di conseguenza lo shader è stato memorizzato nella cache).|  
|Chiaro|Le luci nere non saranno visibili, ma verranno aggiunte al tempo di rendering; si consiglia di ometterli.|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Per ridurre al minimo il tempo di costruzione delle raccolte di grandi dimensioni in [!INCLUDE[TLA#tla_winclient](../../../includes/tlasharptla-winclient-md.md)] , ad esempio MeshGeometry3D's <xref:System.Windows.Media.Media3D.MeshGeometry3D.Positions%2A> , <xref:System.Windows.Media.Media3D.MeshGeometry3D.Normals%2A> , <xref:System.Windows.Media.Media3D.MeshGeometry3D.TextureCoordinates%2A> e <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A> , pre-dimensionare le raccolte prima del popolamento del valore. Se possibile, passare le strutture di dati precompilate dei costruttori delle raccolte, ad esempio matrici o elenchi.|  
  
## <a name="see-also"></a>Vedere anche

- [Panoramica della grafica 3D](3-d-graphics-overview.md)
